\hypertarget{usart__serial_8c}{}\section{usart\+\_\+serial.\+c File Reference}
\label{usart__serial_8c}\index{usart\+\_\+serial.\+c@{usart\+\_\+serial.\+c}}


Module for asynchronous communication with the Atmega2560 U\+S\+A\+RT\textquotesingle{}s.  


{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdarg.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$util/delay.\+h$>$}\\*
{\ttfamily \#include $<$avr/io.\+h$>$}\\*
{\ttfamily \#include $<$avr/interrupt.\+h$>$}\\*
{\ttfamily \#include $<$avr/pgmspace.\+h$>$}\\*
{\ttfamily \#include \char`\"{}Free\+R\+T\+O\+S.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}queue.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ring\+Buffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}bit\+\_\+definitions.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usart\+\_\+serial.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{group__usart_async_module_struct_u_s_a_r_t___c_o_m___b_u_f}{U\+S\+A\+R\+T\+\_\+\+C\+O\+M\+\_\+\+B\+UF}
\begin{DoxyCompactList}\small\item\em Structure of buffers to support communications with a U\+S\+A\+RT.  \hyperlink{group__usart_async_module_struct_u_s_a_r_t___c_o_m___b_u_f}{More...}\end{DoxyCompactList}\item 
struct \hyperlink{group__usart_async_module_struct_u_s_a_r_t___r_e_g_i_s_t_e_r_s}{U\+S\+A\+R\+T\+\_\+\+R\+E\+G\+I\+S\+T\+E\+RS}
\begin{DoxyCompactList}\small\item\em Structure of pointers to U\+S\+A\+RT registers.  \hyperlink{group__usart_async_module_struct_u_s_a_r_t___r_e_g_i_s_t_e_r_s}{More...}\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__usart_async_module_ga2133aeaf30d1d8f6f819d2252dcdbe8c}{R\+X\+C\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_gaa6b8f3261ae9e2e1043380c192f7b5f0}{B\+I\+T7}
\item 
\#define \hyperlink{group__usart_async_module_ga6baa91108d3c2d172e44bc70956b98d2}{T\+X\+C\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_gacc2d074401e2b6322ee8f03476c24677}{B\+I\+T6}
\item 
\#define \hyperlink{group__usart_async_module_ga774a9a790e2e547044eddf47e931a1f8}{U\+D\+R\+E\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_gae692bc3df48028ceb1ddc2534a993bb8}{B\+I\+T5}
\item 
\#define \hyperlink{group__usart_async_module_gaaee51057462df51f411e67a131165914}{F\+E\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_gaa731e0b6cf75f4e637ee88959315f5e4}{B\+I\+T4}
\item 
\#define \hyperlink{group__usart_async_module_ga42bba56b7ce519d770f6791da46b3f64}{D\+O\+R\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_ga8e44574a8a8becc885b05f3bc367ef6a}{B\+I\+T3}
\item 
\#define \hyperlink{group__usart_async_module_gaaa081c9d68175cca9b7a57927616baf1}{U\+P\+E\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_ga9c9560bccccb00174801c728f1ed1399}{B\+I\+T2}
\item 
\#define \hyperlink{group__usart_async_module_gaffd8feb2e774dd114102f1f8be6599aa}{U2\+X\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_ga601923eba46784638244c1ebf2622a2a}{B\+I\+T1}
\item 
\#define \hyperlink{group__usart_async_module_ga4155881309ac7b270c766149bc9a4bbd}{R\+X\+C\+I\+E\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_gaa6b8f3261ae9e2e1043380c192f7b5f0}{B\+I\+T7}
\item 
\#define \hyperlink{group__usart_async_module_gaf64c1f6cfda10c415407572973d3f71c}{U\+D\+R\+I\+E\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_gae692bc3df48028ceb1ddc2534a993bb8}{B\+I\+T5}
\item 
\#define \hyperlink{group__usart_async_module_ga906dab704ddcdb3d2d06384a94126c23}{R\+X\+E\+N\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_gaa731e0b6cf75f4e637ee88959315f5e4}{B\+I\+T4}
\item 
\#define \hyperlink{group__usart_async_module_gae3f799c1bacbb79826d19f6f68c9ddde}{T\+X\+E\+N\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_ga8e44574a8a8becc885b05f3bc367ef6a}{B\+I\+T3}
\item 
\#define \hyperlink{group__usart_async_module_ga9f7f7ba3dc9cf8409364251f5167589d}{U\+C\+S\+Z1\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_ga9c9560bccccb00174801c728f1ed1399}{B\+I\+T2}
\item 
\#define \hyperlink{group__usart_async_module_gabc8fadc00f40b4574889185ded4f33f2}{U\+C\+S\+Z0\+\_\+\+B\+IT}~\hyperlink{group__usart_async_module_ga601923eba46784638244c1ebf2622a2a}{B\+I\+T1}
\item 
\#define \hyperlink{group__usart_async_module_ga6829feca87a1bc576152b06505b91617}{N\+U\+M\+\_\+\+U\+S\+A\+R\+TS}~4
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{group__usart_async_module_gab7cdec2c3d93593769da070a66249537}{U\+S\+A\+R\+T\+\_\+\+S\+T\+A\+TE} \{ \hyperlink{group__usart_async_module_ggab7cdec2c3d93593769da070a66249537a5d79f8d2fc28573243ee81711100aea3}{U\+S\+A\+R\+T\+\_\+\+V\+A\+C\+A\+NT}, 
\hyperlink{group__usart_async_module_ggab7cdec2c3d93593769da070a66249537adad806aad20f29071003811421d4d487}{U\+S\+A\+R\+T\+\_\+\+E\+N\+G\+A\+G\+ED}
 \}\begin{DoxyCompactList}\small\item\em Defines the state of the U\+S\+A\+RT. \end{DoxyCompactList}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int8\+\_\+t \hyperlink{group__usart_async_module_ga590146f26805ddb1810fe874188aa10d}{usart\+Check\+Rx\+Complete} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id)
\begin{DoxyCompactList}\small\item\em Check if reception is complete. The function returns the status of the R\+XC bit of the U\+S\+A\+RT. When set, the bit indicates that data can be read from the U\+S\+A\+RT. \end{DoxyCompactList}\item 
int8\+\_\+t \hyperlink{group__usart_async_module_gaaab3f24aac455dad2295e72f6dff7bb5}{usart\+Check\+Tx\+Ready} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id)
\begin{DoxyCompactList}\small\item\em Check if transmission is complete. The function returns the status of the U\+D\+RE bit of the U\+S\+A\+RT. When set, the bit indicates that data can be written to the U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_gad3cf1cbb614711dcb8b73f7b7066cc24}{usart\+\_\+fprintf\+\_\+arg} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, const char $\ast$format, va\+\_\+list ap)
\item 
void \hyperlink{group__usart_async_module_ga8b9e6d432ec75ce20fd8225d02cd8340}{usart\+\_\+fprintf\+\_\+\+P\+\_\+arg} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, P\+G\+M\+\_\+P format, va\+\_\+list arg)
\item 
void \hyperlink{group__usart_async_module_ga7f6efaab6a3c0a43d34bcce2f45a9062}{usart\+\_\+xfprintf\+\_\+arg} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, const char $\ast$format, va\+\_\+list arg)
\item 
void \hyperlink{group__usart_async_module_ga33e17cf0120f57e061a736a8eeb93fce}{usart\+\_\+xfprintf\+\_\+\+P\+\_\+arg} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, P\+G\+M\+\_\+P format, va\+\_\+list arg)
\item 
void \hyperlink{group__usart_async_module_gaddeaba370b80a1dd990f7f713ba7303f}{xmit\+Interrupt\+\_\+\+On} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID})
\item 
void \hyperlink{group__usart_async_module_ga47ace99c93e8f4b284443b758cab1523}{xmit\+Interrupt\+\_\+\+Off} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID})
\item 
void \hyperlink{group__usart_async_module_ga6e2b4d1b6f5bd3b8cf8a9ad223ad348f}{usart\+\_\+rx\+\_\+isr} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID})
\item 
void \hyperlink{group__usart_async_module_gacc2987796aa72246682121ad6686c67b}{usart\+\_\+tx\+\_\+isr} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID})
\item 
\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} \hyperlink{group__usart_async_module_gae9acc73d962adef7e91a498618ff012f}{usart\+Open} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, uint32\+\_\+t ul\+Wanted\+Baud, uint16\+\_\+t ux\+Tx\+Queue\+Length, uint16\+\_\+t ux\+Rx\+Queue\+Length)
\begin{DoxyCompactList}\small\item\em Open a connection on a U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_gaa679900a334c7873eb71c86fe52cbf40}{set\+Default\+U\+S\+A\+RT} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id)
\begin{DoxyCompactList}\small\item\em Update default U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga6343cf3035ec8972e44716a951a29d42}{usart\+Close} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id)
\begin{DoxyCompactList}\small\item\em Close a connection on a U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga505b60744b81631de13750ca9f5ea1c4}{usart\+\_\+printf} (const char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em Standard printf function. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga0441186875e726f93752dd8e0e95f443}{usart\+\_\+printf\+\_\+P} (P\+G\+M\+\_\+P format,...)
\begin{DoxyCompactList}\small\item\em Standard printf function that uses a formating string stored in memory. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga0f8fdf3d9f7e325fe2297730661facfa}{usart\+\_\+print} (uint8\+\_\+t $\ast$str)
\begin{DoxyCompactList}\small\item\em Print string on default U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_gae30cd27e2ce82fdb87f06b7460a21b4a}{usart\+\_\+print\+\_\+P} (P\+G\+M\+\_\+P str)
\begin{DoxyCompactList}\small\item\em Print string stored in program memory on default U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga7429cdd4ac36c036e982817d6750ed34}{usart\+\_\+fprintf} (int usartid, const char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em Standard printf for specified U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga2b66e28588b8e2d1f92b9f3273608964}{usart\+\_\+fprintf\+\_\+P} (int usart\+Id, P\+G\+M\+\_\+P format,...)
\begin{DoxyCompactList}\small\item\em Standard printf function for specific U\+S\+A\+RT with formating string in program memory. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga5598cc3783a39c313bc27baa10cf9952}{usart\+\_\+fprint} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, uint8\+\_\+t $\ast$str)
\begin{DoxyCompactList}\small\item\em Print string to specific U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_gaa376b136593fb6bc0e5e9f7b35473f14}{usart\+\_\+fprint\+\_\+P} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, P\+G\+M\+\_\+P str)
\begin{DoxyCompactList}\small\item\em Print a string stored in program memory to specific U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga12dffa6d7df2b7e6049e3bc08b939e07}{usart\+Write} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, int8\+\_\+t data\+Out)
\begin{DoxyCompactList}\small\item\em Low level write function (single character). Will delay until usart is ready to accept the 8 bit data. \end{DoxyCompactList}\item 
int8\+\_\+t \hyperlink{group__usart_async_module_ga152b8198df4c2d75e34547a8c13c7457}{usart\+Read} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id)
\begin{DoxyCompactList}\small\item\em Low level read function (single character). Delays until data available from the U\+S\+A\+RT. Will check for reception errors. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga9ec472642da5fe42928fb1d81e3115cd}{usart\+\_\+xprintf} (const char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em Standard printf (interrupt driven) to default U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_gaf7d0d5b028d30f55439119f42ad7ed69}{usart\+\_\+xprintf\+\_\+P} (P\+G\+M\+\_\+P format,...)
\begin{DoxyCompactList}\small\item\em Standard printf (interrupt driven) to default U\+S\+A\+RT using formating string stored in program memory. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_gab5e44adf779c82fd1c56fb8bca7bffb7}{usart\+\_\+xprint} (uint8\+\_\+t $\ast$str)
\begin{DoxyCompactList}\small\item\em Prints a string on the default U\+S\+A\+RT (defined by default\+U\+S\+A\+RT). \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga27ada721bb00993418f8e3ffb1152d52}{usart\+\_\+xprint\+\_\+P} (P\+G\+M\+\_\+P str)
\begin{DoxyCompactList}\small\item\em Prints a string stored in program memory on the default U\+S\+A\+RT (defined by default\+U\+S\+A\+RT). \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga94601796b62f88f4364afbc1ed037d10}{usart\+\_\+xfprintf} (int usart\+Id, const char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em Standard printf function for specific U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga8092a20ae9bed598702da288b55c80c6}{usart\+\_\+xfprintf\+\_\+P} (int usart\+Id, P\+G\+M\+\_\+P format,...)
\begin{DoxyCompactList}\small\item\em Standard printf function for specific U\+S\+A\+RT that uses a formating string stored in program memory. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga7d6d42b48e50bdd87aecab0dc2a9feb6}{usart\+\_\+xfprint} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, uint8\+\_\+t $\ast$str)
\begin{DoxyCompactList}\small\item\em Print string to specific U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_gae8212e8aca5b91172440dc3735dd7ba4}{usart\+\_\+xfprint\+\_\+P} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, P\+G\+M\+\_\+P str)
\begin{DoxyCompactList}\small\item\em Print string stored in program memory to specific U\+S\+A\+RT. \end{DoxyCompactList}\item 
void \hyperlink{group__usart_async_module_ga70e50f1bc6f1abd0cb57c53145a0f06e}{usart\+\_\+xflush\+Rx} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id)
\begin{DoxyCompactList}\small\item\em Flushes all characters in the receive ring buffer (i.\+e. empties the buffer). \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{group__usart_async_module_gae7ed1c85cf0d965f00c8b8b1adc87621}{usart\+\_\+\+Available\+Char\+Rx} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id)
\begin{DoxyCompactList}\small\item\em Gives number of bytes in reception ring buffer. \end{DoxyCompactList}\item 
U\+Base\+Type\+\_\+t \hyperlink{group__usart_async_module_ga3958a2e258e69977428337f1b79b559d}{usart\+\_\+xget\+Char} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, U\+Base\+Type\+\_\+t $\ast$pc\+Rxed\+Char)
\begin{DoxyCompactList}\small\item\em Get a character from the reception ring buffer. \end{DoxyCompactList}\item 
U\+Base\+Type\+\_\+t \hyperlink{group__usart_async_module_ga520a2c4212a37daf9f42e747a7ff420f}{usart\+\_\+xput\+Char} (\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} usart\+Id, const U\+Base\+Type\+\_\+t c\+Out\+Char)
\begin{DoxyCompactList}\small\item\em Drops a character into the transmit ring buffer. \end{DoxyCompactList}\item 
\hyperlink{group__usart_async_module_ga084f0a9cf05b1877bd8a71a90dae7ff8}{I\+SR} (U\+S\+A\+R\+T0\+\_\+\+R\+X\+\_\+vect)
\item 
\hyperlink{group__usart_async_module_gae6e8a8009a9ae0c59f25a496d1cf5a84}{I\+SR} (U\+S\+A\+R\+T1\+\_\+\+R\+X\+\_\+vect)
\item 
\hyperlink{group__usart_async_module_ga63a86aad9ba2e355fe6380da553f554e}{I\+SR} (U\+S\+A\+R\+T2\+\_\+\+R\+X\+\_\+vect)
\item 
\hyperlink{group__usart_async_module_ga88e32db0cad75219c51253f5c1052fc0}{I\+SR} (U\+S\+A\+R\+T3\+\_\+\+R\+X\+\_\+vect)
\item 
\hyperlink{group__usart_async_module_ga95e67e677722a53e3ad9f1ffce2e7408}{I\+SR} (U\+S\+A\+R\+T0\+\_\+\+U\+D\+R\+E\+\_\+vect)
\item 
\hyperlink{group__usart_async_module_gad6441110baf548d12ae53fcbed8075c5}{I\+SR} (U\+S\+A\+R\+T1\+\_\+\+U\+D\+R\+E\+\_\+vect)
\item 
\hyperlink{group__usart_async_module_ga6dd0f9b7dad929f4170efd85c67e04ba}{I\+SR} (U\+S\+A\+R\+T2\+\_\+\+U\+D\+R\+E\+\_\+vect)
\item 
\hyperlink{group__usart_async_module_ga965b31b0729ebabd50c26e4557d9609d}{I\+SR} (U\+S\+A\+R\+T3\+\_\+\+U\+D\+R\+E\+\_\+vect)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__usart_async_module_struct_u_s_a_r_t___r_e_g_i_s_t_e_r_s}{U\+S\+A\+R\+T\+\_\+\+R\+E\+G\+I\+S\+T\+E\+RS} \hyperlink{group__usart_async_module_gaf964270351d58d348a34bfec204765cb}{usart\+Reg} \mbox{[}$\,$\mbox{]}
\item 
\hyperlink{group__usart_async_module_struct_u_s_a_r_t___c_o_m___b_u_f}{U\+S\+A\+R\+T\+\_\+\+C\+O\+M\+\_\+\+B\+UF} \hyperlink{group__usart_async_module_ga01280f1bdc978bbad7a0ae0fca24f0f4}{usart\+Com\+Buf} \mbox{[}\hyperlink{group__usart_async_module_ga6829feca87a1bc576152b06505b91617}{N\+U\+M\+\_\+\+U\+S\+A\+R\+TS}\mbox{]}
\item 
\hyperlink{group__usart_async_module_gaae3c5ea77a411e5f40e4377f77067b86}{U\+S\+A\+R\+T\+\_\+\+ID} \hyperlink{group__usart_async_module_ga88cfc7c9ded2bea56fff795fe46b68c0}{default\+U\+S\+A\+RT} = \hyperlink{group__usart_async_module_ggaae3c5ea77a411e5f40e4377f77067b86a4ee9bfd4dd9ae53d762cc046ce72c892}{U\+S\+A\+R\+T\+\_\+0}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Module for asynchronous communication with the Atmega2560 U\+S\+A\+RT\textquotesingle{}s. 

\begin{DoxyAuthor}{Author}
Gilbert Arbez 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May 26 2015
\end{DoxyDate}
U\+S\+A\+RT Asynchronous Serial Module

Both interrupt driven and polling functions are available.

Uses free\+R\+T\+OS ring buffers to support interrupt functions.

Design Principles

The design of this module is loosely based on the Unix/\+Linux file system which is used to support I/O to various devices (e.\+g. network sockets) in addition to supporting I/O with files. The functions of this system consists of\+:
\begin{DoxyEnumerate}
\item Low level open/close functions to establish and release connections.
\item Low level read() and write() functions for reading and writing a sequence of bytes from and to the connections.
\item Use of an integer handle (which is called the usart identifier, i.\+e. usart\+Id, in this module).
\item Higher level functions that use the read/write functions for formating data.
\item Use of the variable parameter list and the vsprintf function for formating strings.
\end{DoxyEnumerate}

Functions are augmented to provide versions that support the following features
\begin{DoxyEnumerate}
\item No usart identifier, i.\+e., define a standard input/output that can be set to any of the U\+S\+A\+R\+TS
\item Polling functions that do use interrupts and can be used prior to enabling interrupts (i.\+e. the free\+R\+T\+OS scheduler).
\item Interrupt driven functions that uses the free\+R\+T\+OS ring buffer for buffering data. When the buffer is full the taak that is calling the function shall block.
\item Functions which uses formating string stored in program memory.
\item Functions which uses formating strings stored in ram memory.
\end{DoxyEnumerate}

Data Structures Two arrays of data structures are used to implement this module\+:
\begin{DoxyEnumerate}
\item usart\+Reg (array of \hyperlink{group__usart_async_module_struct_u_s_a_r_t___r_e_g_i_s_t_e_r_s}{U\+S\+A\+R\+T\+\_\+\+R\+E\+G\+I\+S\+T\+E\+RS}) -\/ provides pointers to the U\+S\+A\+RT hardware module registers.
\item usart\+Com\+Buf (array of \hyperlink{group__usart_async_module_struct_u_s_a_r_t___c_o_m___b_u_f}{U\+S\+A\+R\+T\+\_\+\+C\+O\+M\+\_\+\+B\+UF}) -\/ provides a set of buffers for each arrays to support communications. Buffering is important for supporting transmission/reception using interrupts. Two ring buffers (x\+Rxed\+Chars and x\+Chars\+For\+Tx) are used to buffer received characters and to buffer characters for transmission. A work buffer (serial\+Work\+Buffer) is used to format strings for transmission (using the Unix/\+Linux printf style).
\end{DoxyEnumerate}

Functions

The functions are divided into two major sets\+:
\begin{DoxyEnumerate}
\item A set of functions that do not use interrupts. These functions can be used prior to invoking the free\+R\+T\+OS scheduler which enables interrupts.\textbackslash{}
\item A set of functions that use interrupts. These functions are used after interrupts are enabled (i.\+e. the free\+R\+T\+OS scheduler has been invoked). These provide more efficient processing since it does not occupy the C\+PU during the transmission of a string.
\end{DoxyEnumerate}

Each of these sets are further subdivided into two\+:
\begin{DoxyEnumerate}
\item A set of functions that uses a default U\+S\+A\+RT (defined by the variable default\+U\+S\+A\+RT)
\item A set of functions with a parameter, usart\+Id, to define the U\+S\+A\+RT used for communications.
\end{DoxyEnumerate}

The format of the entry point function names are as follows (the \+\_\+P suffix indicates that the formating string is stored in program memory rather than R\+AM).
\begin{DoxyEnumerate}
\item Uses default U\+S\+A\+RT
\begin{DoxyItemize}
\item usart\+\_\+printf(...)
\item usart\+\_\+printf\+\_\+P (...)
\end{DoxyItemize}
\item Uses the specified U\+S\+A\+RT
\begin{DoxyItemize}
\item usart\+\_\+fprintf(U\+S\+A\+R\+T\+\_\+\+ID usart\+ID, ...)
\item usart\+\_\+fprintf\+\_\+P(U\+S\+A\+R\+T\+\_\+\+ID usart\+ID, ...)
\end{DoxyItemize}
\item Uses default U\+S\+A\+RT with interrupts
\begin{DoxyItemize}
\item usart\+\_\+xprintf(...)
\item usart\+\_\+xprintf\+\_\+P (...)
\end{DoxyItemize}
\item Uses the specified U\+S\+A\+RT with interrupts
\begin{DoxyItemize}
\item usart\+\_\+xfprintf(U\+S\+A\+R\+T\+\_\+\+ID usart\+ID, ...)
\item usart\+\_\+xfprintf\+\_\+P(U\+S\+A\+R\+T\+\_\+\+ID usart\+ID, ...)
\end{DoxyItemize}
\end{DoxyEnumerate}

Note that printf can be replace by other names (e.\+g. print to print an unformatted string). 